<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.video.web.main.mapper.DataCenterMapper">
    <select id="sumPlayByMap" resultType="java.lang.Long">
        SELECT COALESCE(SUM(uv.play), 0)
        FROM video v
                 JOIN user_video uv ON v.vid = uv.vid
        WHERE v.uid = #{uid}
          AND uv.play_time BETWEEN #{begin} AND #{end}
    </select>
    <select id="sumFansPlayByMap" resultType="java.lang.Long">
        SELECT COALESCE(SUM(uv.play), 0)
        FROM video v
                 JOIN user_video uv ON v.vid = uv.vid
                 JOIN follow f ON f.follower_id = uv.uid
        WHERE v.uid = #{uid}
          AND f.followee_id = #{uid}
          AND uv.play_time BETWEEN #{begin} AND #{end}
    </select>
    <select id="sumLikeByMap" resultType="java.lang.Long">
        SELECT COALESCE(SUM(uv.love), 0)
        FROM video v
                 JOIN user_video uv ON v.vid = uv.vid
        WHERE v.uid = #{uid}
          AND uv.play_time BETWEEN #{begin} AND #{end}
    </select>
</mapper>